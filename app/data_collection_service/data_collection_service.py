import time
from database_helper import Helper
from api_key import API_KEY
import dota2api

class RequestCounter:
	def __init__(self):
		self.request_number = 0
	def increment(self):
		self.request_number += 1

class CollectionService:
	polling_interval = 20.0 # (100 requests in 3600 seconds)
	
	def __init__(self, uri):
		self.running = True
		self.helper = Helper()	
		self.counter = RequestCounter()
		self.api = dota2api.Initialise(API_KEY)
		
	def do_work(self):
		"""The method which is called on each iteration 
		of the polling service."""
		#matches = self.api.get_match_history()
		response = {u'status': 1, u'total_results': 500, u'matches': [{u'dire_team_id': 0, u'match_id': 3313942318, u'start_time': 1500090309, u'match_seq_num': 2892368523, u'radiant_team_id': 0, u'players': [{u'hero_id': 0, u'account_id': 4294967295, u'player_slot': 0}, {u'hero_id': 0, u'account_id': 244140972, u'player_slot': 128}], u'lobby_type': 8}, {u'dire_team_id': 0, u'match_id': 3313941866, u'start_time': 1500090290, u'match_seq_num': 2892369449, u'radiant_team_id': 0, u'players': [{u'hero_id': 6, u'account_id': 168479328, u'player_slot': 0}, {u'hero_id': 50, u'account_id': 100703165, u'player_slot': 1}, {u'hero_id': 0, u'account_id': 118526018, u'player_slot': 2}, {u'hero_id': 64, u'account_id': 104242598, u'player_slot': 3}], u'lobby_type': 4}, {u'dire_team_id': 0, u'match_id': 3313940432, u'start_time': 1500090207, u'match_seq_num': 2892369017, u'radiant_team_id': 0, u'players': [{u'hero_id': 64, u'account_id': 4294967295, u'player_slot': 0}, {u'hero_id': 46, u'account_id': 4294967295, u'player_slot': 1}, {u'hero_id': 0, u'account_id': 4294967295, u'player_slot': 2}, {u'hero_id': 0, u'account_id': 4294967295, u'player_slot': 3}], u'lobby_type': 4}, {u'dire_team_id': 0, u'match_id': 3313940013, u'start_time': 1500090211, u'match_seq_num': 2892369051, u'radiant_team_id': 0, u'players': [{u'hero_id': 0, u'account_id': 187334526, u'player_slot': 0}, {u'hero_id': 21, u'account_id': 189773519, u'player_slot': 1}, {u'hero_id': 50, u'account_id': 299839434, u'player_slot': 2}, {u'hero_id': 104, u'account_id': 130426906, u'player_slot': 3}], u'lobby_type': 4}, {u'dire_team_id': 0, u'match_id': 3313939917, u'start_time': 1500090207, u'match_seq_num': 2892369599, u'radiant_team_id': 0, u'players': [{u'hero_id': 102, u'account_id': 109846058, u'player_slot': 0}, {u'hero_id': 46, u'account_id': 91300142, u'player_slot': 1}, {u'hero_id': 30, u'account_id': 4294967295, u'player_slot': 2}, {u'hero_id': 6, u'account_id': 4294967295, u'player_slot': 3}], u'lobby_type': 4}, {u'dire_team_id': 0, u'match_id': 3313939869, u'start_time': 1500090202, u'match_seq_num': 2892369372, u'radiant_team_id': 0, u'players': [{u'hero_id': 46, u'account_id': 327976026, u'player_slot': 0}, {u'hero_id': 95, u'account_id': 399277719, u'player_slot': 1}, {u'hero_id': 11, u'account_id': 254686841, u'player_slot': 2}, {u'hero_id': 104, u'account_id': 4294967295, u'player_slot': 3}], u'lobby_type': 4}, {u'dire_team_id': 0, u'match_id': 3313939716, u'start_time': 1500090197, u'match_seq_num': 2892367561, u'radiant_team_id': 0, u'players': [{u'hero_id': 0, u'account_id': 4294967295, u'player_slot': 0}, {u'hero_id': 95, u'account_id': 4294967295, u'player_slot': 1}, {u'hero_id': 29, u'account_id': 101830464, u'player_slot': 2}, {u'hero_id': 11, u'account_id': 156092709, u'player_slot': 3}], u'lobby_type': 4}, {u'dire_team_id': 0, u'match_id': 3313939461, u'start_time': 1500090187, u'match_seq_num': 2892368055, u'radiant_team_id': 0, u'players': [{u'hero_id': 25, u'account_id': 356441851, u'player_slot': 0}, {u'hero_id': 0, u'account_id': 125703581, u'player_slot': 1}, {u'hero_id': 0, u'account_id': 110090705, u'player_slot': 2}, {u'hero_id': 0, u'account_id': 141562832, u'player_slot': 3}], u'lobby_type': 4}, {u'dire_team_id': 0, u'match_id': 3313938289, u'start_time': 1500090139, u'match_seq_num': 2892369357, u'radiant_team_id': 0, u'players': [{u'hero_id': 29, u'account_id': 217138291, u'player_slot': 0}, {u'hero_id': 95, u'account_id': 4294967295, u'player_slot': 1}, {u'hero_id': 30, u'account_id': 4294967295, u'player_slot': 2}, {u'hero_id': 46, u'account_id': 300457195, u'player_slot': 3}], u'lobby_type': 4}, {u'dire_team_id': 0, u'match_id': 3313937361, u'start_time': 1500090095, u'match_seq_num': 2892367043, u'radiant_team_id': 0, u'players': [{u'hero_id': 102, u'account_id': 4294967295, u'player_slot': 0}, {u'hero_id': 64, u'account_id': 4294967295, u'player_slot': 1}, {u'hero_id': 0, u'account_id': 184893671, u'player_slot': 2}, {u'hero_id': 95, u'account_id': 177330821, u'player_slot': 3}], u'lobby_type': 4}, {u'dire_team_id': 0, u'match_id': 3313937319, u'start_time': 1500090069, u'match_seq_num': 2892369719, u'radiant_team_id': 0, u'players': [{u'hero_id': 25, u'account_id': 4294967295, u'player_slot': 0}, {u'hero_id': 6, u'account_id': 4294967295, u'player_slot': 1}, {u'hero_id': 11, u'account_id': 4294967295, u'player_slot': 2}, {u'hero_id': 95, u'account_id': 4294967295, u'player_slot': 3}], u'lobby_type': 4}, {u'dire_team_id': 0, u'match_id': 3313936922, u'start_time': 1500090085, u'match_seq_num': 2892367702, u'radiant_team_id': 0, u'players': [{u'hero_id': 46, u'account_id': 4294967295, u'player_slot': 0}, {u'hero_id': 102, u'account_id': 4294967295, u'player_slot': 1}, {u'hero_id': 18, u'account_id': 4294967295, u'player_slot': 2}, {u'hero_id': 104, u'account_id': 4294967295, u'player_slot': 3}], u'lobby_type': 4}, {u'dire_team_id': 0, u'match_id': 3313936788, u'start_time': 1500090077, u'match_seq_num': 2892368797, u'radiant_team_id': 0, u'players': [{u'hero_id': 6, u'account_id': 4294967295, u'player_slot': 0}, {u'hero_id': 104, u'account_id': 4294967295, u'player_slot': 1}, {u'hero_id': 30, u'account_id': 369611921, u'player_slot': 2}, {u'hero_id': 21, u'account_id': 4294967295, u'player_slot': 3}], u'lobby_type': 4}, {u'dire_team_id': 0, u'match_id': 3313936771, u'start_time': 1500090072, u'match_seq_num': 2892365486, u'radiant_team_id': 0, u'players': [{u'hero_id': 0, u'account_id': 4294967295, u'player_slot': 0}, {u'hero_id': 0, u'account_id': 4294967295, u'player_slot': 1}, {u'hero_id': 0, u'account_id': 4294967295, u'player_slot': 2}, {u'hero_id': 0, u'account_id': 4294967295, u'player_slot': 3}, {u'hero_id': 0, u'account_id': 4294967295, u'player_slot': 4}, {u'hero_id': 0, u'account_id': 4294967295, u'player_slot': 128}, {u'hero_id': 0, u'account_id': 323901220, u'player_slot': 129}, {u'hero_id': 0, u'account_id': 308740339, u'player_slot': 130}, {u'hero_id': 0, u'account_id': 4294967295, u'player_slot': 131}, {u'hero_id': 0, u'account_id': 301716754, u'player_slot': 132}], u'lobby_type': 0}, {u'dire_team_id': 0, u'match_id': 3313936758, u'start_time': 1500090077, u'match_seq_num': 2892368142, u'radiant_team_id': 0, u'players': [{u'hero_id': 6, u'account_id': 4294967295, u'player_slot': 0}, {u'hero_id': 102, u'account_id': 4294967295, u'player_slot': 1}, {u'hero_id': 21, u'account_id': 192164929, u'player_slot': 2}, {u'hero_id': 95, u'account_id': 4294967295, u'player_slot': 3}], u'lobby_type': 4}, {u'dire_team_id': 0, u'match_id': 3313936281, u'start_time': 1500090052, u'match_seq_num': 2892367237, u'radiant_team_id': 0, u'players': [{u'hero_id': 94, u'account_id': 4294967295, u'player_slot': 0}, {u'hero_id': 89, u'account_id': 4294967295, u'player_slot': 1}, {u'hero_id': 90, u'account_id': 4294967295, u'player_slot': 2}, {u'hero_id': 112, u'account_id': 4294967295, u'player_slot': 3}, {u'hero_id': 113, u'account_id': 4294967295, u'player_slot': 4}, {u'hero_id': 48, u'account_id': 133953754, u'player_slot': 128}, {u'hero_id': 29, u'account_id': 150770840, u'player_slot': 129}, {u'hero_id': 71, u'account_id': 123896955, u'player_slot': 130}, {u'hero_id': 87, u'account_id': 4294967295, u'player_slot': 131}, {u'hero_id': 76, u'account_id': 219591133, u'player_slot': 132}], u'lobby_type': 0}, {u'dire_team_id': 0, u'match_id': 3313936072, u'start_time': 1500090044, u'match_seq_num': 2892367539, u'radiant_team_id': 0, u'players': [{u'hero_id': 25, u'account_id': 4294967295, u'player_slot': 0}, {u'hero_id': 95, u'account_id': 4294967295, u'player_slot': 1}, {u'hero_id': 102, u'account_id': 93157157, u'player_slot': 2}, {u'hero_id': 21, u'account_id': 4294967295, u'player_slot': 3}], u'lobby_type': 4}, {u'dire_team_id': 0, u'match_id': 3313935939, u'start_time': 1500090021, u'match_seq_num': 2892368884, u'radiant_team_id': 0, u'players': [{u'hero_id': 104, u'account_id': 254811791, u'player_slot': 0}, {u'hero_id': 50, u'account_id': 4294967295, u'player_slot': 1}, {u'hero_id': 21, u'account_id': 86874728, u'player_slot': 2}, {u'hero_id': 11, u'account_id': 143106243, u'player_slot': 3}], u'lobby_type': 4}, {u'dire_team_id': 0, u'match_id': 3313935762, u'start_time': 1500090035, u'match_seq_num': 2892368693, u'radiant_team_id': 0, u'players': [{u'hero_id': 30, u'account_id': 135603309, u'player_slot': 0}, {u'hero_id': 104, u'account_id': 442336112, u'player_slot': 1}, {u'hero_id': 18, u'account_id': 192679639, u'player_slot': 2}, {u'hero_id': 95, u'account_id': 130583574, u'player_slot': 3}], u'lobby_type': 4}, {u'dire_team_id': 0, u'match_id': 3313935752, u'start_time': 1500090014, u'match_seq_num': 2892368909, u'radiant_team_id': 0, u'players': [{u'hero_id': 64, u'account_id': 4294967295, u'player_slot': 0}, {u'hero_id': 104, u'account_id': 4294967295, u'player_slot': 1}, {u'hero_id': 25, u'account_id': 4294967295, u'player_slot': 2}, {u'hero_id': 6, u'account_id': 4294967295, u'player_slot': 3}], u'lobby_type': 4}, {u'dire_team_id': 0, u'match_id': 3313935678, u'start_time': 1500090030, u'match_seq_num': 2892365313, u'radiant_team_id': 0, u'players': [{u'hero_id': 104, u'account_id': 143121633, u'player_slot': 0}, {u'hero_id': 6, u'account_id': 89209330, u'player_slot': 1}, {u'hero_id': 95, u'account_id': 144305251, u'player_slot': 2}, {u'hero_id': 50, u'account_id': 252143893, u'player_slot': 3}], u'lobby_type': 4}, {u'dire_team_id': 0, u'match_id': 3313935535, u'start_time': 1500090022, u'match_seq_num': 2892368717, u'radiant_team_id': 0, u'players': [{u'hero_id': 64, u'account_id': 4294967295, u'player_slot': 0}, {u'hero_id': 104, u'account_id': 4294967295, u'player_slot': 1}, {u'hero_id': 18, u'account_id': 298619059, u'player_slot': 2}, {u'hero_id': 25, u'account_id': 262585480, u'player_slot': 3}], u'lobby_type': 4}, {u'dire_team_id': 0, u'match_id': 3313935270, u'start_time': 1500090014, u'match_seq_num': 2892364922, u'radiant_team_id': 0, u'players': [{u'hero_id': 18, u'account_id': 4294967295, u'player_slot': 0}, {u'hero_id': 95, u'account_id': 4294967295, u'player_slot': 1}, {u'hero_id': 25, u'account_id': 318091557, u'player_slot': 2}, {u'hero_id': 6, u'account_id': 4294967295, u'player_slot': 3}], u'lobby_type': 4}, {u'dire_team_id': 0, u'match_id': 3313935198, u'start_time': 1500090008, u'match_seq_num': 2892365575, u'radiant_team_id': 0, u'players': [{u'hero_id': 0, u'account_id': 4294967295, u'player_slot': 0}, {u'hero_id': 0, u'account_id': 4294967295, u'player_slot': 128}], u'lobby_type': 8}, {u'dire_team_id': 0, u'match_id': 3313935124, u'start_time': 1500089998, u'match_seq_num': 2892368880, u'radiant_team_id': 0, u'players': [{u'hero_id': 79, u'account_id': 60112447, u'player_slot': 0}, {u'hero_id': 26, u'account_id': 4294967295, u'player_slot': 1}, {u'hero_id': 9, u'account_id': 4294967295, u'player_slot': 2}, {u'hero_id': 105, u'account_id': 95728153, u'player_slot': 3}, {u'hero_id': 23, u'account_id': 4294967295, u'player_slot': 4}, {u'hero_id': 10, u'account_id': 86116376, u'player_slot': 128}, {u'hero_id': 30, u'account_id': 4294967295, u'player_slot': 129}, {u'hero_id': 75, u'account_id': 4294967295, u'player_slot': 130}, {u'hero_id': 90, u'account_id': 4294967295, u'player_slot': 131}, {u'hero_id': 53, u'account_id': 4294967295, u'player_slot': 132}], u'lobby_type': 0}, {u'dire_team_id': 0, u'match_id': 3313934957, u'start_time': 1500089995, u'match_seq_num': 2892366696, u'radiant_team_id': 0, u'players': [{u'hero_id': 30, u'account_id': 114557694, u'player_slot': 0}, {u'hero_id': 6, u'account_id': 305684414, u'player_slot': 1}, {u'hero_id': 29, u'account_id': 254740620, u'player_slot': 2}, {u'hero_id': 95, u'account_id': 4294967295, u'player_slot': 3}], u'lobby_type': 4}, {u'dire_team_id': 0, u'match_id': 3313934871, u'start_time': 1500089995, u'match_seq_num': 2892364869, u'radiant_team_id': 0, u'players': [{u'hero_id': 21, u'account_id': 108590588, u'player_slot': 0}, {u'hero_id': 0, u'account_id': 4294967295, u'player_slot': 1}, {u'hero_id': 0, u'account_id': 4294967295, u'player_slot': 2}, {u'hero_id': 0, u'account_id': 3362584, u'player_slot': 3}], u'lobby_type': 4}, {u'dire_team_id': 0, u'match_id': 3313934852, u'start_time': 1500089993, u'match_seq_num': 2892368144, u'radiant_team_id': 0, u'players': [{u'hero_id': 50, u'account_id': 4294967295, u'player_slot': 0}, {u'hero_id': 11, u'account_id': 157893030, u'player_slot': 1}, {u'hero_id': 21, u'account_id': 135870185, u'player_slot': 2}, {u'hero_id': 25, u'account_id': 122650329, u'player_slot': 3}], u'lobby_type': 4}, {u'dire_team_id': 0, u'match_id': 3313934844, u'start_time': 1500089995, u'match_seq_num': 2892368072, u'radiant_team_id': 0, u'players': [{u'hero_id': 18, u'account_id': 4294967295, u'player_slot': 0}, {u'hero_id': 6, u'account_id': 150937191, u'player_slot': 1}, {u'hero_id': 21, u'account_id': 4294967295, u'player_slot': 2}, {u'hero_id': 64, u'account_id': 4294967295, u'player_slot': 3}], u'lobby_type': 4}, {u'dire_team_id': 0, u'match_id': 3313934842, u'start_time': 1500089994, u'match_seq_num': 2892363288, u'radiant_team_id': 0, u'players': [{u'hero_id': 0, u'account_id': 350157780, u'player_slot': 0}, {u'hero_id': 0, u'account_id': 191947767, u'player_slot': 1}, {u'hero_id': 0, u'account_id': 4294967295, u'player_slot': 2}, {u'hero_id': 0, u'account_id': 354840356, u'player_slot': 3}, {u'hero_id': 0, u'account_id': 443947355, u'player_slot': 4}, {u'hero_id': 0, u'account_id': 145491911, u'player_slot': 128}, {u'hero_id': 0, u'account_id': 173223762, u'player_slot': 129}, {u'hero_id': 0, u'account_id': 4294967295, u'player_slot': 130}, {u'hero_id': 0, u'account_id': 387232141, u'player_slot': 131}, {u'hero_id': 0, u'account_id': 4294967295, u'player_slot': 132}], u'lobby_type': 0}, {u'dire_team_id': 0, u'match_id': 3313934613, u'start_time': 1500089978, u'match_seq_num': 2892369044, u'radiant_team_id': 0, u'players': [{u'hero_id': 104, u'account_id': 4993576, u'player_slot': 0}, {u'hero_id': 18, u'account_id': 4294967295, u'player_slot': 1}, {u'hero_id': 95, u'account_id': 141193072, u'player_slot': 2}, {u'hero_id': 6, u'account_id': 4294967295, u'player_slot': 3}], u'lobby_type': 4}, {u'dire_team_id': 0, u'match_id': 3313934504, u'start_time': 1500089980, u'match_seq_num': 2892369513, u'radiant_team_id': 0, u'players': [{u'hero_id': 30, u'account_id': 84849566, u'player_slot': 0}, {u'hero_id': 102, u'account_id': 105356945, u'player_slot': 1}, {u'hero_id': 18, u'account_id': 100328301, u'player_slot': 2}, {u'hero_id': 6, u'account_id': 128052438, u'player_slot': 3}], u'lobby_type': 4}, {u'dire_team_id': 0, u'match_id': 3313934503, u'start_time': 1500089980, u'match_seq_num': 2892368450, u'radiant_team_id': 0, u'players': [{u'hero_id': 104, u'account_id': 4294967295, u'player_slot': 0}, {u'hero_id': 64, u'account_id': 164493644, u'player_slot': 1}, {u'hero_id': 6, u'account_id': 179655077, u'player_slot': 2}, {u'hero_id': 95, u'account_id': 138796255, u'player_slot': 3}], u'lobby_type': 4}, {u'dire_team_id': 0, u'match_id': 3313934423, u'start_time': 1500089980, u'match_seq_num': 2892365642, u'radiant_team_id': 0, u'players': [{u'hero_id': 30, u'account_id': 4294967295, u'player_slot': 0}, {u'hero_id': 95, u'account_id': 101668386, u'player_slot': 1}, {u'hero_id': 21, u'account_id': 4294967295, u'player_slot': 2}, {u'hero_id': 6, u'account_id': 4294967295, u'player_slot': 3}], u'lobby_type': 4}, {u'dire_team_id': 0, u'match_id': 3313934261, u'start_time': 1500089970, u'match_seq_num': 2892364616, u'radiant_team_id': 0, u'players': [{u'hero_id': 0, u'account_id': 374652331, u'player_slot': 0}, {u'hero_id': 0, u'account_id': 4294967295, u'player_slot': 128}], u'lobby_type': 8}, {u'dire_team_id': 0, u'match_id': 3313934223, u'start_time': 1500089966, u'match_seq_num': 2892366390, u'radiant_team_id': 0, u'players': [{u'hero_id': 95, u'account_id': 4294967295, u'player_slot': 0}, {u'hero_id': 104, u'account_id': 219147047, u'player_slot': 1}, {u'hero_id': 30, u'account_id': 330926646, u'player_slot': 2}, {u'hero_id': 6, u'account_id': 4294967295, u'player_slot': 3}], u'lobby_type': 4}, {u'dire_team_id': 0, u'match_id': 3313934198, u'start_time': 1500089967, u'match_seq_num': 2892368181, u'radiant_team_id': 0, u'players': [{u'hero_id': 104, u'account_id': 337929415, u'player_slot': 0}, {u'hero_id': 95, u'account_id': 371080360, u'player_slot': 1}, {u'hero_id': 6, u'account_id': 4294967295, u'player_slot': 2}, {u'hero_id': 29, u'account_id': 247035511, u'player_slot': 3}], u'lobby_type': 4}, {u'dire_team_id': 0, u'match_id': 3313934132, u'start_time': 1500089966, u'match_seq_num': 2892367570, u'radiant_team_id': 0, u'players': [{u'hero_id': 30, u'account_id': 4294967295, u'player_slot': 0}, {u'hero_id': 104, u'account_id': 103060424, u'player_slot': 1}, {u'hero_id': 29, u'account_id': 4294967295, u'player_slot': 2}, {u'hero_id': 6, u'account_id': 347232669, u'player_slot': 3}], u'lobby_type': 4}, {u'dire_team_id': 0, u'match_id': 3313933886, u'start_time': 1500089941, u'match_seq_num': 2892367635, u'radiant_team_id': 0, u'players': [{u'hero_id': 95, u'account_id': 342822916, u'player_slot': 0}, {u'hero_id': 6, u'account_id': 4294967295, u'player_slot': 1}, {u'hero_id': 64, u'account_id': 4294967295, u'player_slot': 2}, {u'hero_id': 18, u'account_id': 351441416, u'player_slot': 3}], u'lobby_type': 4}, {u'dire_team_id': 0, u'match_id': 3313933866, u'start_time': 1500089951, u'match_seq_num': 2892365827, u'radiant_team_id': 0, u'players': [{u'hero_id': 21, u'account_id': 4294967295, u'player_slot': 0}, {u'hero_id': 18, u'account_id': 4294967295, u'player_slot': 1}, {u'hero_id': 104, u'account_id': 4294967295, u'player_slot': 2}, {u'hero_id': 19, u'account_id': 67375937, u'player_slot': 3}], u'lobby_type': 4}, {u'dire_team_id': 0, u'match_id': 3313933818, u'start_time': 1500089952, u'match_seq_num': 2892364946, u'radiant_team_id': 0, u'players': [{u'hero_id': 102, u'account_id': 182689107, u'player_slot': 0}, {u'hero_id': 95, u'account_id': 4294967295, u'player_slot': 1}, {u'hero_id': 64, u'account_id': 4294967295, u'player_slot': 2}, {u'hero_id': 104, u'account_id': 176998852, u'player_slot': 3}], u'lobby_type': 4}, {u'dire_team_id': 0, u'match_id': 3313933692, u'start_time': 1500089938, u'match_seq_num': 2892367141, u'radiant_team_id': 0, u'players': [{u'hero_id': 29, u'account_id': 4294967295, u'player_slot': 0}, {u'hero_id': 46, u'account_id': 196822790, u'player_slot': 1}, {u'hero_id': 11, u'account_id': 4294967295, u'player_slot': 2}, {u'hero_id': 102, u'account_id': 4294967295, u'player_slot': 3}], u'lobby_type': 4}, {u'dire_team_id': 0, u'match_id': 3313933647, u'start_time': 1500089938, u'match_seq_num': 2892364496, u'radiant_team_id': 0, u'players': [{u'hero_id': 102, u'account_id': 120900904, u'player_slot': 0}, {u'hero_id': 95, u'account_id': 4294967295, u'player_slot': 1}, {u'hero_id': 29, u'account_id': 101830464, u'player_slot': 2}, {u'hero_id': 25, u'account_id': 156092709, u'player_slot': 3}], u'lobby_type': 4}, {u'dire_team_id': 0, u'match_id': 3313933614, u'start_time': 1500089939, u'match_seq_num': 2892368158, u'radiant_team_id': 0, u'players': [{u'hero_id': 18, u'account_id': 4294967295, u'player_slot': 0}, {u'hero_id': 6, u'account_id': 4294967295, u'player_slot': 1}, {u'hero_id': 21, u'account_id': 4294967295, u'player_slot': 2}, {u'hero_id': 95, u'account_id': 166946640, u'player_slot': 3}], u'lobby_type': 4}, {u'dire_team_id': 0, u'match_id': 3313933576, u'start_time': 1500089941, u'match_seq_num': 2892368570, u'radiant_team_id': 0, u'players': [{u'hero_id': 35, u'account_id': 4294967295, u'player_slot': 0}, {u'hero_id': 36, u'account_id': 4294967295, u'player_slot': 128}], u'lobby_type': 8}, {u'dire_team_id': 0, u'match_id': 3313933507, u'start_time': 1500089938, u'match_seq_num': 2892365052, u'radiant_team_id': 0, u'players': [{u'hero_id': 95, u'account_id': 137936544, u'player_slot': 0}, {u'hero_id': 21, u'account_id': 192024298, u'player_slot': 1}, {u'hero_id': 18, u'account_id': 354221499, u'player_slot': 2}, {u'hero_id': 64, u'account_id': 137351194, u'player_slot': 3}], u'lobby_type': 4}, {u'dire_team_id': 0, u'match_id': 3313933506, u'start_time': 1500089939, u'match_seq_num': 2892367598, u'radiant_team_id': 0, u'players': [{u'hero_id': 11, u'account_id': 4294967295, u'player_slot': 0}, {u'hero_id': 30, u'account_id': 416518286, u'player_slot': 1}, {u'hero_id': 95, u'account_id': 374881430, u'player_slot': 2}, {u'hero_id': 6, u'account_id': 375726674, u'player_slot': 3}], u'lobby_type': 4}, {u'dire_team_id': 0, u'match_id': 3313933354, u'start_time': 1500089928, u'match_seq_num': 2892363390, u'radiant_team_id': 0, u'players': [{u'hero_id': 0, u'account_id': 4294967295, u'player_slot': 0}, {u'hero_id': 0, u'account_id': 412840546, u'player_slot': 128}], u'lobby_type': 8}, {u'dire_team_id': 0, u'match_id': 3313933306, u'start_time': 1500089928, u'match_seq_num': 2892365012, u'radiant_team_id': 0, u'players': [{u'hero_id': 4, u'account_id': 4294967295, u'player_slot': 0}, {u'hero_id': 13, u'account_id': 4294967295, u'player_slot': 128}], u'lobby_type': 8}, {u'dire_team_id': 0, u'match_id': 3313932900, u'start_time': 1500089907, u'match_seq_num': 2892369713, u'radiant_team_id': 0, u'players': [{u'hero_id': 92, u'account_id': 241812952, u'player_slot': 0}, {u'hero_id': 97, u'account_id': 149360208, u'player_slot': 1}, {u'hero_id': 18, u'account_id': 130812128, u'player_slot': 2}, {u'hero_id': 57, u'account_id': 155216493, u'player_slot': 3}, {u'hero_id': 8, u'account_id': 222852385, u'player_slot': 4}, {u'hero_id': 43, u'account_id': 4294967295, u'player_slot': 128}, {u'hero_id': 27, u'account_id': 245225245, u'player_slot': 129}, {u'hero_id': 47, u'account_id': 248223115, u'player_slot': 130}, {u'hero_id': 87, u'account_id': 4294967295, u'player_slot': 131}, {u'hero_id': 77, u'account_id': 4294967295, u'player_slot': 132}], u'lobby_type': 0}, {u'dire_team_id': 0, u'match_id': 3313932853, u'start_time': 1500089909, u'match_seq_num': 2892366389, u'radiant_team_id': 0, u'players': [{u'hero_id': 6, u'account_id': 125728209, u'player_slot': 0}, {u'hero_id': 95, u'account_id': 106396893, u'player_slot': 1}, {u'hero_id': 46, u'account_id': 4294967295, u'player_slot': 2}, {u'hero_id': 102, u'account_id': 4294967295, u'player_slot': 3}], u'lobby_type': 4}, {u'dire_team_id': 0, u'match_id': 3313932614, u'start_time': 1500089899, u'match_seq_num': 2892365026, u'radiant_team_id': 0, u'players': [{u'hero_id': 104, u'account_id': 256612028, u'player_slot': 0}, {u'hero_id': 19, u'account_id': 4294967295, u'player_slot': 1}, {u'hero_id': 95, u'account_id': 352543309, u'player_slot': 2}, {u'hero_id': 18, u'account_id': 354870532, u'player_slot': 3}], u'lobby_type': 4}, {u'dire_team_id': 0, u'match_id': 3313932366, u'start_time': 1500089882, u'match_seq_num': 2892367663, u'radiant_team_id': 0, u'players': [{u'hero_id': 65, u'account_id': 4294967295, u'player_slot': 0}, {u'hero_id': 75, u'account_id': 4294967295, u'player_slot': 128}], u'lobby_type': 8}, {u'dire_team_id': 0, u'match_id': 3313932332, u'start_time': 1500089889, u'match_seq_num': 2892362706, u'radiant_team_id': 0, u'players': [{u'hero_id': 50, u'account_id': 4294967295, u'player_slot': 0}, {u'hero_id': 18, u'account_id': 132493107, u'player_slot': 1}, {u'hero_id': 95, u'account_id': 4294967295, u'player_slot': 2}, {u'hero_id': 21, u'account_id': 207396958, u'player_slot': 3}], u'lobby_type': 4}, {u'dire_team_id': 0, u'match_id': 3313932307, u'start_time': 1500089889, u'match_seq_num': 2892363185, u'radiant_team_id': 0, u'players': [{u'hero_id': 102, u'account_id': 412775947, u'player_slot': 0}, {u'hero_id': 64, u'account_id': 137521663, u'player_slot': 1}, {u'hero_id': 95, u'account_id': 138578906, u'player_slot': 2}, {u'hero_id': 21, u'account_id': 139677015, u'player_slot': 3}], u'lobby_type': 4}, {u'dire_team_id': 0, u'match_id': 3313932303, u'start_time': 1500089887, u'match_seq_num': 2892367003, u'radiant_team_id': 0, u'players': [{u'hero_id': 11, u'account_id': 372247685, u'player_slot': 0}, {u'hero_id': 32, u'account_id': 4294967295, u'player_slot': 128}], u'lobby_type': 8}, {u'dire_team_id': 0, u'match_id': 3313932257, u'start_time': 1500089887, u'match_seq_num': 2892367459, u'radiant_team_id': 0, u'players': [{u'hero_id': 6, u'account_id': 168479328, u'player_slot': 0}, {u'hero_id': 95, u'account_id': 100703165, u'player_slot': 1}, {u'hero_id': 46, u'account_id': 118526018, u'player_slot': 2}, {u'hero_id': 30, u'account_id': 104242598, u'player_slot': 3}], u'lobby_type': 4}, {u'dire_team_id': 0, u'match_id': 3313932105, u'start_time': 1500089877, u'match_seq_num': 2892365205, u'radiant_team_id': 0, u'players': [{u'hero_id': 18, u'account_id': 144131731, u'player_slot': 0}, {u'hero_id': 95, u'account_id': 150231254, u'player_slot': 1}, {u'hero_id': 6, u'account_id': 171371120, u'player_slot': 2}, {u'hero_id': 104, u'account_id': 195962133, u'player_slot': 3}], u'lobby_type': 4}, {u'dire_team_id': 0, u'match_id': 3313932020, u'start_time': 1500089869, u'match_seq_num': 2892367720, u'radiant_team_id': 0, u'players': [{u'hero_id': 25, u'account_id': 4294967295, u'player_slot': 0}, {u'hero_id': 102, u'account_id': 149314945, u'player_slot': 1}, {u'hero_id': 18, u'account_id': 176276427, u'player_slot': 2}, {u'hero_id': 95, u'account_id': 18072194, u'player_slot': 3}], u'lobby_type': 4}, {u'dire_team_id': 0, u'match_id': 3313931953, u'start_time': 1500089874, u'match_seq_num': 2892365196, u'radiant_team_id': 0, u'players': [{u'hero_id': 95, u'account_id': 4294967295, u'player_slot': 0}, {u'hero_id': 6, u'account_id': 214131873, u'player_slot': 1}, {u'hero_id': 104, u'account_id': 235645207, u'player_slot': 2}, {u'hero_id': 64, u'account_id': 4294967295, u'player_slot': 3}], u'lobby_type': 4}, {u'dire_team_id': 0, u'match_id': 3313931884, u'start_time': 1500089869, u'match_seq_num': 2892362767, u'radiant_team_id': 0, u'players': [{u'hero_id': 95, u'account_id': 4294967295, u'player_slot': 0}, {u'hero_id': 6, u'account_id': 4294967295, u'player_slot': 1}, {u'hero_id': 64, u'account_id': 4294967295, u'player_slot': 2}, {u'hero_id': 104, u'account_id': 129860115, u'player_slot': 3}], u'lobby_type': 4}, {u'dire_team_id': 0, u'match_id': 3313931864, u'start_time': 1500089857, u'match_seq_num': 2892363402, u'radiant_team_id': 0, u'players': [{u'hero_id': 30, u'account_id': 4294967295, u'player_slot': 0}, {u'hero_id': 95, u'account_id': 117468414, u'player_slot': 1}, {u'hero_id': 18, u'account_id': 197218601, u'player_slot': 2}, {u'hero_id': 64, u'account_id': 4294967295, u'player_slot': 3}], u'lobby_type': 4}, {u'dire_team_id': 0, u'match_id': 3313931766, u'start_time': 1500089860, u'match_seq_num': 2892364055, u'radiant_team_id': 0, u'players': [{u'hero_id': 95, u'account_id': 4294967295, u'player_slot': 0}, {u'hero_id': 6, u'account_id': 4294967295, u'player_slot': 1}, {u'hero_id': 64, u'account_id': 4294967295, u'player_slot': 2}, {u'hero_id': 104, u'account_id': 4294967295, u'player_slot': 3}], u'lobby_type': 4}, {u'dire_team_id': 0, u'match_id': 3313931674, u'start_time': 1500089854, u'match_seq_num': 2892362801, u'radiant_team_id': 0, u'players': [{u'hero_id': 0, u'account_id': 150062702, u'player_slot': 0}, {u'hero_id': 0, u'account_id': 4294967295, u'player_slot': 1}, {u'hero_id': 0, u'account_id': 136063094, u'player_slot': 2}, {u'hero_id': 0, u'account_id': 4294967295, u'player_slot': 3}], u'lobby_type': 4}, {u'dire_team_id': 0, u'match_id': 3313931627, u'start_time': 1500089859, u'match_seq_num': 2892362001, u'radiant_team_id': 0, u'players': [{u'hero_id': 64, u'account_id': 306475672, u'player_slot': 0}, {u'hero_id': 29, u'account_id': 148009064, u'player_slot': 1}, {u'hero_id': 21, u'account_id': 4294967295, u'player_slot': 2}, {u'hero_id': 50, u'account_id': 4294967295, u'player_slot': 3}], u'lobby_type': 4}, {u'dire_team_id': 0, u'match_id': 3313931528, u'start_time': 1500089857, u'match_seq_num': 2892366562, u'radiant_team_id': 0, u'players': [{u'hero_id': 50, u'account_id': 119645368, u'player_slot': 0}, {u'hero_id': 21, u'account_id': 140485004, u'player_slot': 1}, {u'hero_id': 18, u'account_id': 144519473, u'player_slot': 2}, {u'hero_id': 6, u'account_id': 4294967295, u'player_slot': 3}], u'lobby_type': 4}, {u'dire_team_id': 0, u'match_id': 3313931465, u'start_time': 1500089855, u'match_seq_num': 2892366221, u'radiant_team_id': 0, u'players': [{u'hero_id': 18, u'account_id': 4294967295, u'player_slot': 0}, {u'hero_id': 6, u'account_id': 314940511, u'player_slot': 1}, {u'hero_id': 95, u'account_id': 239090201, u'player_slot': 2}, {u'hero_id': 11, u'account_id': 4294967295, u'player_slot': 3}], u'lobby_type': 4}, {u'dire_team_id': 0, u'match_id': 3313931400, u'start_time': 1500089848, u'match_seq_num': 2892364009, u'radiant_team_id': 0, u'players': [{u'hero_id': 102, u'account_id': 82929450, u'player_slot': 0}, {u'hero_id': 18, u'account_id': 200973815, u'player_slot': 1}, {u'hero_id': 95, u'account_id': 179263626, u'player_slot': 2}, {u'hero_id': 6, u'account_id': 4294967295, u'player_slot': 3}], u'lobby_type': 4}, {u'dire_team_id': 0, u'match_id': 3313931361, u'start_time': 1500089814, u'match_seq_num': 2892367871, u'radiant_team_id': 0, u'players': [{u'hero_id': 84, u'account_id': 4294967295, u'player_slot': 0}, {u'hero_id': 35, u'account_id': 4294967295, u'player_slot': 128}], u'lobby_type': 8}, {u'dire_team_id': 0, u'match_id': 3313931270, u'start_time': 1500089823, u'match_seq_num': 2892361905, u'radiant_team_id': 0, u'players': [{u'hero_id': 30, u'account_id': 4294967295, u'player_slot': 0}, {u'hero_id': 0, u'account_id': 101668386, u'player_slot': 1}, {u'hero_id': 21, u'account_id': 4294967295, u'player_slot': 2}, {u'hero_id': 0, u'account_id': 4294967295, u'player_slot': 3}], u'lobby_type': 4}, {u'dire_team_id': 0, u'match_id': 3313931220, u'start_time': 1500089844, u'match_seq_num': 2892364632, u'radiant_team_id': 0, u'players': [{u'hero_id': 20, u'account_id': 4294967295, u'player_slot': 0}, {u'hero_id': 35, u'account_id': 4294967295, u'player_slot': 128}], u'lobby_type': 8}, {u'dire_team_id': 0, u'match_id': 3313931177, u'start_time': 1500089839, u'match_seq_num': 2892369557, u'radiant_team_id': 0, u'players': [{u'hero_id': 14, u'account_id': 153248632, u'player_slot': 0}, {u'hero_id': 16, u'account_id': 182371442, u'player_slot': 1}, {u'hero_id': 18, u'account_id': 331499002, u'player_slot': 2}, {u'hero_id': 88, u'account_id': 276817038, u'player_slot': 3}, {u'hero_id': 111, u'account_id': 328846455, u'player_slot': 4}, {u'hero_id': 61, u'account_id': 229740258, u'player_slot': 128}, {u'hero_id': 55, u'account_id': 207900981, u'player_slot': 129}, {u'hero_id': 95, u'account_id': 136521633, u'player_slot': 130}, {u'hero_id': 69, u'account_id': 139986281, u'player_slot': 131}, {u'hero_id': 42, u'account_id': 327116485, u'player_slot': 132}], u'lobby_type': 0}, {u'dire_team_id': 0, u'match_id': 3313931157, u'start_time': 1500089840, u'match_seq_num': 2892367782, u'radiant_team_id': 0, u'players': [{u'hero_id': 64, u'account_id': 150312582, u'player_slot': 0}, {u'hero_id': 6, u'account_id': 4294967295, u'player_slot': 1}, {u'hero_id': 95, u'account_id': 4294967295, u'player_slot': 2}, {u'hero_id': 30, u'account_id': 194318103, u'player_slot': 3}], u'lobby_type': 4}, {u'dire_team_id': 0, u'match_id': 3313931052, u'start_time': 1500089836, u'match_seq_num': 2892368945, u'radiant_team_id': 0, u'players': [{u'hero_id': 90, u'account_id': 223942095, u'player_slot': 0}, {u'hero_id': 71, u'account_id': 197676795, u'player_slot': 1}, {u'hero_id': 42, u'account_id': 196587741, u'player_slot': 2}, {u'hero_id': 9, u'account_id': 144440710, u'player_slot': 3}, {u'hero_id': 87, u'account_id': 406445531, u'player_slot': 4}, {u'hero_id': 63, u'account_id': 332211998, u'player_slot': 128}, {u'hero_id': 6, u'account_id': 144484421, u'player_slot': 129}, {u'hero_id': 57, u'account_id': 335634898, u'player_slot': 130}, {u'hero_id': 70, u'account_id': 237201257, u'player_slot': 131}, {u'hero_id': 61, u'account_id': 126720029, u'player_slot': 132}], u'lobby_type': 0}, {u'dire_team_id': 0, u'match_id': 3313930989, u'start_time': 1500089823, u'match_seq_num': 2892363838, u'radiant_team_id': 0, u'players': [{u'hero_id': 18, u'account_id': 171346027, u'player_slot': 0}, {u'hero_id': 95, u'account_id': 172560266, u'player_slot': 1}, {u'hero_id': 30, u'account_id': 300254787, u'player_slot': 2}, {u'hero_id': 6, u'account_id': 298925218, u'player_slot': 3}], u'lobby_type': 4}, {u'dire_team_id': 0, u'match_id': 3313930981, u'start_time': 1500089833, u'match_seq_num': 2892367664, u'radiant_team_id': 0, u'players': [{u'hero_id': 95, u'account_id': 328874405, u'player_slot': 0}, {u'hero_id': 102, u'account_id': 182369875, u'player_slot': 1}, {u'hero_id': 18, u'account_id': 146777253, u'player_slot': 2}, {u'hero_id': 25, u'account_id': 220178707, u'player_slot': 3}], u'lobby_type': 4}, {u'dire_team_id': 0, u'match_id': 3313930891, u'start_time': 1500089830, u'match_seq_num': 2892369784, u'radiant_team_id': 0, u'players': [{u'hero_id': 95, u'account_id': 137976900, u'player_slot': 0}, {u'hero_id': 104, u'account_id': 155096812, u'player_slot': 1}, {u'hero_id': 64, u'account_id': 164961642, u'player_slot': 2}, {u'hero_id': 19, u'account_id': 4294967295, u'player_slot': 3}], u'lobby_type': 4}, {u'dire_team_id': 0, u'match_id': 3313930827, u'start_time': 1500089827, u'match_seq_num': 2892365542, u'radiant_team_id': 0, u'players': [{u'hero_id': 95, u'account_id': 4294967295, u'player_slot': 0}, {u'hero_id': 18, u'account_id': 44795177, u'player_slot': 1}, {u'hero_id': 64, u'account_id': 4294967295, u'player_slot': 2}, {u'hero_id': 11, u'account_id': 54521765, u'player_slot': 3}], u'lobby_type': 4}, {u'dire_team_id': 0, u'match_id': 3313930700, u'start_time': 1500089823, u'match_seq_num': 2892366522, u'radiant_team_id': 0, u'players': [{u'hero_id': 6, u'account_id': 4294967295, u'player_slot': 0}, {u'hero_id': 21, u'account_id': 4294967295, u'player_slot': 1}, {u'hero_id': 104, u'account_id': 4294967295, u'player_slot': 2}, {u'hero_id': 19, u'account_id': 4294967295, u'player_slot': 3}], u'lobby_type': 4}, {u'dire_team_id': 0, u'match_id': 3313930698, u'start_time': 1500089823, u'match_seq_num': 2892369237, u'radiant_team_id': 0, u'players': [{u'hero_id': 6, u'account_id': 200311660, u'player_slot': 0}, {u'hero_id': 30, u'account_id': 4294967295, u'player_slot': 1}, {u'hero_id': 104, u'account_id': 124068020, u'player_slot': 2}, {u'hero_id': 64, u'account_id': 137090471, u'player_slot': 3}], u'lobby_type': 4}, {u'dire_team_id': 0, u'match_id': 3313930650, u'start_time': 1500089819, u'match_seq_num': 2892368455, u'radiant_team_id': 0, u'players': [{u'hero_id': 6, u'account_id': 4294967295, u'player_slot': 0}, {u'hero_id': 102, u'account_id': 4294967295, u'player_slot': 1}, {u'hero_id': 25, u'account_id': 4294967295, u'player_slot': 2}, {u'hero_id': 95, u'account_id': 4294967295, u'player_slot': 3}], u'lobby_type': 4}, {u'dire_team_id': 0, u'match_id': 3313930523, u'start_time': 1500089810, u'match_seq_num': 2892364207, u'radiant_team_id': 0, u'players': [{u'hero_id': 6, u'account_id': 4294967295, u'player_slot': 0}, {u'hero_id': 18, u'account_id': 162635125, u'player_slot': 1}, {u'hero_id': 104, u'account_id': 4294967295, u'player_slot': 2}, {u'hero_id': 95, u'account_id': 187732186, u'player_slot': 3}], u'lobby_type': 4}, {u'dire_team_id': 0, u'match_id': 3313930441, u'start_time': 1500089803, u'match_seq_num': 2892369189, u'radiant_team_id': 0, u'players': [{u'hero_id': 53, u'account_id': 4294967295, u'player_slot': 0}, {u'hero_id': 9, u'account_id': 4294967295, u'player_slot': 1}, {u'hero_id': 3, u'account_id': 4294967295, u'player_slot': 2}, {u'hero_id': 25, u'account_id': 4294967295, u'player_slot': 3}, {u'hero_id': 49, u'account_id': 4294967295, u'player_slot': 4}, {u'hero_id': 106, u'account_id': 4294967295, u'player_slot': 128}, {u'hero_id': 40, u'account_id': 4294967295, u'player_slot': 129}, {u'hero_id': 65, u'account_id': 4294967295, u'player_slot': 130}, {u'hero_id': 95, u'account_id': 4294967295, u'player_slot': 131}, {u'hero_id': 57, u'account_id': 4294967295, u'player_slot': 132}], u'lobby_type': 0}, {u'dire_team_id': 0, u'match_id': 3313930164, u'start_time': 1500089796, u'match_seq_num': 2892366781, u'radiant_team_id': 0, u'players': [{u'hero_id': 53, u'account_id': 153972544, u'player_slot': 0}, {u'hero_id': 6, u'account_id': 104369484, u'player_slot': 1}, {u'hero_id': 48, u'account_id': 100259669, u'player_slot': 2}, {u'hero_id': 61, u'account_id': 4294967295, u'player_slot': 3}, {u'hero_id': 102, u'account_id': 53351127, u'player_slot': 4}, {u'hero_id': 82, u'account_id': 89171556, u'player_slot': 128}, {u'hero_id': 30, u'account_id': 4294967295, u'player_slot': 129}, {u'hero_id': 112, u'account_id': 107965116, u'player_slot': 130}, {u'hero_id': 92, u'account_id': 193614031, u'player_slot': 131}, {u'hero_id': 63, u'account_id': 95762105, u'player_slot': 132}], u'lobby_type': 0}, {u'dire_team_id': 0, u'match_id': 3313930041, u'start_time': 1500089794, u'match_seq_num': 2892368283, u'radiant_team_id': 0, u'players': [{u'hero_id': 50, u'account_id': 353112433, u'player_slot': 0}, {u'hero_id': 63, u'account_id': 272489808, u'player_slot': 1}, {u'hero_id': 82, u'account_id': 115092915, u'player_slot': 2}, {u'hero_id': 96, u'account_id': 136191859, u'player_slot': 3}, {u'hero_id': 31, u'account_id': 151623735, u'player_slot': 4}, {u'hero_id': 53, u'account_id': 4294967295, u'player_slot': 128}, {u'hero_id': 54, u'account_id': 139458228, u'player_slot': 129}, {u'hero_id': 103, u'account_id': 324900134, u'player_slot': 130}, {u'hero_id': 46, u'account_id': 248359191, u'player_slot': 131}, {u'hero_id': 88, u'account_id': 4294967295, u'player_slot': 132}], u'lobby_type': 0}, {u'dire_team_id': 0, u'match_id': 3313929925, u'start_time': 1500089789, u'match_seq_num': 2892369244, u'radiant_team_id': 0, u'players': [{u'hero_id': 28, u'account_id': 377123860, u'player_slot': 0}, {u'hero_id': 69, u'account_id': 359961997, u'player_slot': 1}, {u'hero_id': 19, u'account_id': 214759781, u'player_slot': 2}, {u'hero_id': 7, u'account_id': 188409967, u'player_slot': 3}, {u'hero_id': 2, u'account_id': 270672820, u'player_slot': 4}, {u'hero_id': 64, u'account_id': 138809747, u'player_slot': 128}, {u'hero_id': 25, u'account_id': 186430364, u'player_slot': 129}, {u'hero_id': 99, u'account_id': 139321763, u'player_slot': 130}, {u'hero_id': 47, u'account_id': 129489331, u'player_slot': 131}, {u'hero_id': 63, u'account_id': 179448804, u'player_slot': 132}], u'lobby_type': 0}, {u'dire_team_id': 0, u'match_id': 3313929889, u'start_time': 1500089783, u'match_seq_num': 2892368102, u'radiant_team_id': 0, u'players': [{u'hero_id': 36, u'account_id': 163340653, u'player_slot': 0}, {u'hero_id': 10, u'account_id': 4294967295, u'player_slot': 1}, {u'hero_id': 23, u'account_id': 136337519, u'player_slot': 2}, {u'hero_id': 93, u'account_id': 216332198, u'player_slot': 3}, {u'hero_id': 110, u'account_id': 122129285, u'player_slot': 4}, {u'hero_id': 94, u'account_id': 240032757, u'player_slot': 128}, {u'hero_id': 84, u'account_id': 275609588, u'player_slot': 129}, {u'hero_id': 16, u'account_id': 343473954, u'player_slot': 130}, {u'hero_id': 19, u'account_id': 127354539, u'player_slot': 131}, {u'hero_id': 63, u'account_id': 144654381, u'player_slot': 132}], u'lobby_type': 0}, {u'dire_team_id': 0, u'match_id': 3313929887, u'start_time': 1500089784, u'match_seq_num': 2892360730, u'radiant_team_id': 0, u'players': [{u'hero_id': 0, u'account_id': 4294967295, u'player_slot': 0}, {u'hero_id': 0, u'account_id': 413412044, u'player_slot': 128}], u'lobby_type': 8}, {u'dire_team_id': 0, u'match_id': 3313929873, u'start_time': 1500089788, u'match_seq_num': 2892365995, u'radiant_team_id': 0, u'players': [{u'hero_id': 19, u'account_id': 126945892, u'player_slot': 0}, {u'hero_id': 102, u'account_id': 86897691, u'player_slot': 1}, {u'hero_id': 50, u'account_id': 4294967295, u'player_slot': 2}, {u'hero_id': 21, u'account_id': 362142532, u'player_slot': 3}], u'lobby_type': 4}, {u'dire_team_id': 0, u'match_id': 3313929850, u'start_time': 1500089781, u'match_seq_num': 2892365764, u'radiant_team_id': 0, u'players': [{u'hero_id': 50, u'account_id': 354092301, u'player_slot': 0}, {u'hero_id': 0, u'account_id': 4294967295, u'player_slot': 1}, {u'hero_id': 104, u'account_id': 4294967295, u'player_slot': 2}, {u'hero_id': 19, u'account_id': 4294967295, u'player_slot': 3}], u'lobby_type': 4}, {u'dire_team_id': 0, u'match_id': 3313929799, u'start_time': 1500089783, u'match_seq_num': 2892364193, u'radiant_team_id': 0, u'players': [{u'hero_id': 6, u'account_id': 345418163, u'player_slot': 0}, {u'hero_id': 104, u'account_id': 344362564, u'player_slot': 1}, {u'hero_id': 95, u'account_id': 355028413, u'player_slot': 2}, {u'hero_id': 102, u'account_id': 4294967295, u'player_slot': 3}], u'lobby_type': 4}, {u'dire_team_id': 0, u'match_id': 3313929754, u'start_time': 1500089781, u'match_seq_num': 2892363413, u'radiant_team_id': 0, u'players': [{u'hero_id': 25, u'account_id': 4294967295, u'player_slot': 0}, {u'hero_id': 6, u'account_id': 105115702, u'player_slot': 1}, {u'hero_id': 95, u'account_id': 418957901, u'player_slot': 2}, {u'hero_id': 11, u'account_id': 4294967295, u'player_slot': 3}], u'lobby_type': 4}, {u'dire_team_id': 0, u'match_id': 3313929675, u'start_time': 1500089776, u'match_seq_num': 2892368257, u'radiant_team_id': 0, u'players': [{u'hero_id': 8, u'account_id': 4294967295, u'player_slot': 0}, {u'hero_id': 35, u'account_id': 4294967295, u'player_slot': 128}], u'lobby_type': 8}, {u'dire_team_id': 0, u'match_id': 3313929515, u'start_time': 1500089769, u'match_seq_num': 2892361280, u'radiant_team_id': 0, u'players': [{u'hero_id': 95, u'account_id': 237568858, u'player_slot': 0}, {u'hero_id': 6, u'account_id': 385886337, u'player_slot': 1}, {u'hero_id': 18, u'account_id': 4294967295, u'player_slot': 2}, {u'hero_id': 104, u'account_id': 4294967295, u'player_slot': 3}], u'lobby_type': 4}, {u'dire_team_id': 0, u'match_id': 3313929470, u'start_time': 1500089769, u'match_seq_num': 2892362343, u'radiant_team_id': 0, u'players': [{u'hero_id': 104, u'account_id': 4294967295, u'player_slot': 0}, {u'hero_id': 102, u'account_id': 144686427, u'player_slot': 1}, {u'hero_id': 11, u'account_id': 137933300, u'player_slot': 2}, {u'hero_id': 21, u'account_id': 186068353, u'player_slot': 3}], u'lobby_type': 4}, {u'dire_team_id': 0, u'match_id': 3313929429, u'start_time': 1500089767, u'match_seq_num': 2892362682, u'radiant_team_id': 0, u'players': [{u'hero_id': 25, u'account_id': 4294967295, u'player_slot': 0}, {u'hero_id': 6, u'account_id': 382128325, u'player_slot': 1}, {u'hero_id': 11, u'account_id': 416618335, u'player_slot': 2}, {u'hero_id': 21, u'account_id': 4294967295, u'player_slot': 3}], u'lobby_type': 4}, {u'dire_team_id': 0, u'match_id': 3313929390, u'start_time': 1500089763, u'match_seq_num': 2892369671, u'radiant_team_id': 0, u'players': [{u'hero_id': 46, u'account_id': 4294967295, u'player_slot': 0}, {u'hero_id': 18, u'account_id': 4294967295, u'player_slot': 1}, {u'hero_id': 11, u'account_id': 4294967295, u'player_slot': 2}, {u'hero_id': 19, u'account_id': 205907902, u'player_slot': 3}], u'lobby_type': 4}, {u'dire_team_id': 0, u'match_id': 3313929144, u'start_time': 1500089754, u'match_seq_num': 2892361115, u'radiant_team_id': 0, u'players': [{u'hero_id': 6, u'account_id': 207500729, u'player_slot': 0}, {u'hero_id': 0, u'account_id': 187336229, u'player_slot': 1}, {u'hero_id': 64, u'account_id': 182118769, u'player_slot': 2}, {u'hero_id': 25, u'account_id': 157383327, u'player_slot': 3}], u'lobby_type': 4}, {u'dire_team_id': 0, u'match_id': 3313928917, u'start_time': 1500089746, u'match_seq_num': 2892362911, u'radiant_team_id': 0, u'players': [{u'hero_id': 95, u'account_id': 4294967295, u'player_slot': 0}, {u'hero_id': 18, u'account_id': 4294967295, u'player_slot': 1}, {u'hero_id': 6, u'account_id': 261358396, u'player_slot': 2}, {u'hero_id': 104, u'account_id': 287846474, u'player_slot': 3}], u'lobby_type': 4}, {u'dire_team_id': 0, u'match_id': 3313928836, u'start_time': 1500089724, u'match_seq_num': 2892363370, u'radiant_team_id': 0, u'players': [{u'hero_id': 64, u'account_id': 136329779, u'player_slot': 0}, {u'hero_id': 18, u'account_id': 4294967295, u'player_slot': 1}, {u'hero_id': 21, u'account_id': 211936118, u'player_slot': 2}, {u'hero_id': 30, u'account_id': 110103552, u'player_slot': 3}], u'lobby_type': 4}], u'num_results': 100, u'results_remaining': 400}

		print(response)
		self.helper.map_json_to_matches_table_schema(response)
		self.helper.commit_match_history_data()
		self.counter.increment()
		print("Completed request number: " + `self.counter.request_number`)

	def start(self):
		"""Starting scripting"""
		
		try:
			self.helper.create_match_table()
		except:
			print("Could not create the database table.")
			print("The database table may already exist.")
		try:
			self.helper.create_player_table()
		except:
			print("Could not create the database table.")
			print("The database table may already exist.")

			
		while self.running:
			"""Starts a polling service which collects data for us."""
			start= time.clock()
			self.do_work()
			work_duration = time.clock() - start
			time.sleep(self.polling_interval - work_duration)
			self.running = False

if __name__ == "__main__":
	CollectionService(uri).start()
